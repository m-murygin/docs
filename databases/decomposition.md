# Декомпозиция

## Функциональная зависимость
1. Если в двух строках одинаковое значение в столбце `B` => у них одинаковое значение в столбце `C`
1. Не должно существовать экземпляров таблицы, в которых это правило нарушается
1. Тогда B **функционально определяет** C: `B -> C`.
1. `B` в этой ситуации называется детерминантом в функциональной зависимости
1. Функциональная зависимость является _тривиальной_ если `X -> X`

## Декомпозиция без потерь
1. Пусть в таблице `T` есть атрибуты `A`, `B` и `C`:
    ```
    T = {A,B,C}
    ```
1. Если `B -> C` то декомпозиция:
    ```
    T1 = {A,B}
    T2 = {B,C}
    ```

    является _декомпозицией без потерь_ и

    ```
    T = T1 JOIN T2
    ```

## Нормальная форма Бойса-Кодда
1. _В любой нетривиальной фунциональной зависимости детерминантом является ключ_
1. Если выписать все функциональные зависимости в нашей БД, и в каждой из этих зависимостей детерминантом является ключ - то база находится в _нормальной форме Бойса-Кодда_

## Ошибки при проектировании БД
1. Не корректный составной ключ
    * таблица
        | University | Researcher | Conference | City |
        | --- | --- | --- | --- |
    * Ключ {Researcher, Conference}:
    * с одной тороны кажется что всё норм, т.к. имееются следующие зависимости
        * `Researcher, Conference -> University`
        * `Researcher, Conference -> City`
    * но по факту
        * `Researcher -> University`
        * `Conference -> City`
    * таким образом детерминантом является не ключ а его часть, поэтому имеем нарушении нормальной формы Бойса-Кодда
1. Не являющийся ключом детерминант
    * таблица Researchers
        | University | Address | Resercher Key |
        | --- | --- | --- |
    * С одной стороны зависимости выглядят вот так
        * `Researcher -> University`
        * `Researcher -> Address`
    * Но если присмотреться то адресс университета зависит не от исследователя а от университета:
        * `University -> Address`
    * Получаем детерминант который не является ключом => нарушение нормальной формы
1. Не все столбцы являющиеся ключевыми таковыми объявлены
    * таблица Researchers
        | University | Researcher Key | Email |
        | --- | --- | --- |
    * Email в данной ситуации должен быть объявлен как `Unique`
1. Сввязь 1:N вместо M:N
    * таблица Researchers

        | University | Researcher | Conference |
        | --- | --- | --- |
        | FK: University.Name | Key | FK: Conference.Name |
