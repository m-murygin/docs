# Массивы

## Массивы
1. Массив - набор однотипных элементов, расположенных в памяти друг за другом, доступ к которым осуществляется по индексу
1. С++ позволяет определять массивы на стеке
    ```cpp
    // array 1 2 3 4 5 0 0 0 0 0
    int m[10] = { 1, 2, 3, 4, 5};
    ```
1. Переменная массива хранит указатель на первый элемент этого массива.
1. Получение значения по индексу работает следующим образом
    ```
    m[i] => *(m + i)
    ```
1. Арифметика указателей
    ```cpp
    int m[10] = {1, 2, 3, 4, 5};
    int *p = &m[0]; // адрес начала массива
    int *q = &m[9]; // адрес последнего элемента массива
    ```
    * `(p + k)` - сдвиг на `k` ячеек типа _int_ вправо
    * `(p - k)` - сдвиг на `k` ячеек типа _int_ влево
    * `(q - p)` - количество ячеек между указателями
    * `p[k]` - эквивалентно `*(p + k)`
1. Заполнениие массива по указателю
    ```cpp
    int m[10] = {};
    for (int *p = m; p < m+9; ++p)
    {
        *p = (p - m) + 1;
    }
    // массив заполнен числами от 1 до 10
    ```
1. Передача массива в функцию
    ```cpp
    int max_element (int *m, int size) {
        int max = *m;
        for (int i = 1; i < size; ++i) {
            if (m[i] > max) {
                max = m[i];
            }
        }
        return max
    }
    ```

## Многомерные встроенные массивы
1. С++ позволяет определять многомерные массивы
    ```cpp
    int m2d[2][3] = { {1, 2, 3}, {4, 5, 6} };
    for (size_t i = 0; i != 2; ++i ) {
        for (size_t j = 0; j !=3; ++j) {
            cout << m2d[i][j] << ' ';
        }
        cout << endl;
    }
    ```
1. Элементы m2d располагаются в памяти по строчкам

## Динамические массивы
1. Для выделения одномерных динамических массивов обычно используют оператор `new []`.
    ```cpp
    int * m1d = new int [100];
    ```
1. Какой тип долен быть у указателя на двумерный массив ?
    * Пусть `m` - указатель на двумерный массив типа `int`.
    * Значит `m[i][j]` имеет тип `int` (точнее `int &`).
    * `m[i][j]` <=> `*(m[i] + j)`, т.е. тип `m[i]` - `int *`
    * аналогично `m[i]` <=> `* (m + i)`, т.е. тип `m` - `int **`.
1. Чему соответствует значение `m[i]` ?
    * Это адрес строки с номером `i`.
1. Чему соотвествует значение `m`
    * Это адрес массива с указателями на строки.

## Двумерные массивы
1. Неэффективная схема
    ![2 Dimentional Array](../images/2-dimentinal-array.png)

    ```cpp
    int ** create_array2d(size_t a, size_t b) {
        int ** m = new int * [a];
        for (size_t i = 0; i != a; ++i) {
            m[i] = new int [b];
        }

        return m;
    }

    void free_array2d (int ** m, size_t a) {
        for (size_t i = 0; i != a; ++i) {
            delete [] m[i];
        }

        delete [];
    }
    ```

1. Эффективная схема

    ![2 Dimentional Array Effective](../images/2-dimentinal-array-effective.png)

    ```cpp
    int ** create_array2d (size_t a, size_t b) {
        int ** m = new int * [a];
        m[0] = new int[a * b];

        for (size_t i = 1; i != a; ++i) {
            m[i] = m[i - 1] + b;
        }

        return m;
    }

    void free_array2d (int ** m) {
        delete [] m[0];
        delete [] m;
    }
    ```

