# Static

## Глобальные переменные
1. Объявление глобальных переменных

    ```cpp
    extern int global;
    ```

1. Определение глобальное переменной

    ```cpp
    global = 10;
    ```

1. При отсутствии определения, инициализируются 0 (в отличии от локальных переменных).

1. Время жизни:
    * Инициализируются при запуске программы
    * Заканчивается при выходе из программы

1. Хранится в специальном разделе памяти для хранения глобальных переменных.

1. Недостатки
    * _Мастабируемость_. К примеру есть объект использующий глобальную переменную, тогда нам нужно будет контролировать их взаимодейтвие друг с другом. Усложнится многопоточная разработка.
    * _Побочные эффекты_ - т.е. поведение функции зависит не только от её аргументов.
    * _Порядок инициализации_ - порядок инициализации не определён, и как следствие может возникнуть неопределенность в определении этих переменных.

## Статические глобальные переменные
1. Статическая глобальне переменная - это глобальная переменная, доступная только в пределах модуля.
1. Определение
    ```cpp
    static int global = 10;

    void f () {
        ++global;
    }
    ```
1. В соседнем модуле можно определить статическую глобальную переменную с таким же именем.
1. Проблемы:
    * Масштабируемость (многопоточность)
    * Побочные эффекты

## Статическая локальная переменная
1. Статическая локальная переменная - это глобальная переменная, доступная только в пределах функции.

1. Время жизни такой переменной - от первого вызова функции до конца программы.

1. Пример:
    ```cpp
    int next(int start = 0) {
        static int k = start;
        return k++;
    }

    next(10); // 10
    next(20); // 11
    ```
1. Проблемы:
    * Мастабируемость
    * Побочные эффекты

## Статические функции
1. Статическая функция - это функция, доступная только в пределах модуля
1. В разных `.cpp` файлах можно определить статические функции с одним и тем же именем.
1. Статические глобальные переменные и статические функции проходят _внутреннюю линковку_.

## Статические поля класса
1. Статические поля класса - это глобальные переменные, определённые внутри класса.

    ```cpp
    struct User {
        User() {
            ++instances_;
        }

        ~User() {
            --instances_;
        }
    private:
        static size_t instances_;
    }

    size_t User::instances_ = 0;
    ```
1. Определить такую переменную нужно снаружи класса.
1. Для доступа к статическим полям не нужен объект.

## Статические методы
1. Статические методы - функции определённые внутри класса и имеющие доступ к закрытым полям и методам.

    ```cpp
    struct User {
        ...
        static size_t count() { return instances_; }
        static void transform(User user) {
            // we are able to access private fields
        }
    private:
        static size_t instances_;
    }
    ```
